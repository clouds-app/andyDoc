(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-09ec51be"],{"0e4a":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:"column"===t.flexDirection?"bodyContentDownBox-V":"bodyContentDownBox-H"},[t.$slots.part1?i("div",{staticClass:"bodyContentDownItem",style:{width:t.config.windowOffsetWidth+"px"}},[t._t("part1",[t._v("part1")])],2):t._e(),t.$slots.part2?i("div",{staticClass:"bodyContentDownItem",style:{width:t.config.windowOffsetWidth+"px"}},[t._t("part2",[t._v("part2")])],2):t._e(),t.$slots.part3?i("div",{staticClass:"bodyContentDownItem",style:{width:t.config.windowOffsetWidth+"px"}},[t._t("part3",[t._v("part3")])],2):t._e()])},o=[],a={name:"bodyContentDownItem",props:{flexDirection:{type:String,default:"column"},config:{type:Object,default:function(){return{windowOffsetHeight:0,windowOffsetWidth:0}}}},data:function(){return{}},methods:{}},n=a,r=(i("33bc"),i("5d22")),l=Object(r["a"])(n,s,o,!1,null,"550d1612",null);e["a"]=l.exports},"2cb6":function(t,e,i){"use strict";i("4b9d")},"33bc":function(t,e,i){"use strict";i("c294")},"4b9d":function(t,e,i){},"6a88":function(t,e,i){"use strict";i("9ee8")},"9ee8":function(t,e,i){},aa3b:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bodyContentBox"},[i("div",{ref:"refBodyContent",staticClass:"bodyContentItem lastItem"},[i("bodyContentDownItem",{attrs:{config:{windowOffsetHeight:t.windowOffsetHeight,windowOffsetWidth:t.windowOffsetWidth}},scopedSlots:t._u([{key:"part1",fn:function(){return[i("div",{staticClass:"roleItemBox",style:{height:.3*t.windowOffsetHeight+"px"}},[i("div",{staticClass:"roleItem firstItem"},[i("nvxe-grid",{ref:"mainTable",attrs:{isMainTable:!0,loading:t.listLoading,toolbarConfig:t.toolbarConfig,height:.3*t.windowOffsetHeight,columnsFormName:t.requstConfig.mainFormName,dataUrl:t.requstConfig.modulePreUrl+"/"+t.mainPageSearchType},on:{setCurrentRow:t.setCurrentRowEvent,"cell-click":t.cellClickEvent}})],1),i("div",{staticClass:"roleItem secondItem"},[i("nvxe-grid",{ref:"fourthTable",attrs:{toolbarConfigShow:!1,height:.3*t.windowOffsetHeight,columnsFormName:t.requstConfig.tab4FormName}})],1)])]},proxy:!0},{key:"part2",fn:function(){return[i("div",{staticClass:"rightItemBox",style:{height:.7*t.windowOffsetHeight+"px"}},[i("div",{staticClass:"rightItem firstItem"},[i("div",{staticClass:"sysFunctionMenuBox"},[i("div",{staticClass:"sysFunctionMenuItem upItem"},[i("span",{staticClass:"cl-title-cb margin-left-10"},[t._v("系统功能目录")])]),i("div",{staticClass:"sysFunctionMenuItem downItem"},[i("el-tree",{ref:"roleSourceTree",staticStyle:{"font-size":"13px"},attrs:{data:t.menuDataList,"node-key":"id","highlight-current":!0,"expand-on-click-node":!1,"render-content":function(e,i){var s=i.node,o=i.data,a=i.store;return t.renderContent(e,{node:s,data:o,store:a},"label")}},on:{"node-click":t.handleNodeClick}})],1)])]),i("div",{staticClass:"rightItem secondItem"},[i("nvxe-edit-grid",{ref:"firstTable",attrs:{resizable:!1,loading:t.firstTableLoading,toolbarConfigShow:!1,checkboxColumnShow:!1,height:.7*t.windowOffsetHeight,columnsFormName:t.requstConfig.tab1FormName},on:{"header-cell-dblclick":function(e){return t.headerCellDblClickEvent("firstTable",e)},"cell-dblclick":function(e){return t.indexCellDblClickEvent("firstTable",e)}}})],1),i("div",{staticClass:"rightItem thirdItem"},[i("nvxe-edit-grid",{ref:"secondTable",attrs:{resizable:!1,loading:t.secondTableLoading,toolbarConfigShow:!1,checkboxColumnShow:!1,height:.7*t.windowOffsetHeight,columnsFormName:t.requstConfig.tab2FormName},on:{"header-cell-dblclick":function(e){return t.headerCellDblClickEvent("secondTable",e)}}})],1),i("div",{staticClass:"rightItem fourthItem"},[i("nvxe-edit-grid",{ref:"thirdTable",attrs:{resizable:!1,loading:t.thirdTableLoading,toolbarConfigShow:!1,checkboxColumnShow:!1,height:.7*t.windowOffsetHeight,columnsFormName:t.requstConfig.tab3FormName},on:{"header-cell-dblclick":function(e){return t.headerCellDblClickEvent("thirdTable",e)}}})],1)])]},proxy:!0}])})],1),i("editBox",{ref:"editBox",on:{submitSuccess:t.submitSuccess}}),i("editRoleUsers",{ref:"editRoleUsers",attrs:{currentRoleId:t.currentRoleId},on:{refreshDataList:t.refreshDataList,submitSuccess:t.submitSuccess}})],1)},o=[],a=(i("3337"),i("b3b0"),i("a5f8"),i("16ca"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("nvxe-modal",{attrs:{title:t.title,subTitle:t.subTitle,loading:t.vxeModalLoading},on:{confirm:function(e){return t.submitEvent()}},model:{value:t.showEditBox,callback:function(e){t.showEditBox=e},expression:"showEditBox"}},[i("div",{ref:"editBoxBodyContent",staticClass:"editBoxBodyContentDefaultHW"},[i("editBoxContentPartition",{attrs:{config:{windowOffsetHeight:t.windowOffsetHeight,windowOffsetWidth:t.windowOffsetWidth}},scopedSlots:t._u([{key:"part1",fn:function(){return[i("formItemRender",{ref:"renderForm",attrs:{formValueChangeRes:t.formValueChangeRes,showEditBox:t.showEditBox,firstFormRules:t.requiredRule[t.requstConfig.mainFormName],firstFormData:t.firstFormData,formItemList:t.formItemList,mainFormName:t.requstConfig.mainFormName},on:{formItemValueEvent:t.formItemValueEvent}})]},proxy:!0}])})],1)])}),n=[],r=i("5180"),l=i.n(r),c=i("cb39"),d=i("bf8c"),f={name:"edit-bank",mixins:[d["a"]],components:{formItemRender:c["a"]},data:function(){return{requstConfig:{modulePreUrl:"/sys/role",mainFormName:"sysroleFm"}}},methods:{closeWindowAction:function(){this.firstFormData=l()(this.formDefaultDataObj)},setDefaultValue:function(t){this.firstFormData=l()(t)},submitEvent:function(){this.submitSingleTableEvent()}},created:function(){}},u=f,h=(i("ab8f"),i("5d22")),m=Object(h["a"])(u,a,n,!1,null,"76e20cb4",null),b=m.exports,g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("nvxe-modal",{attrs:{title:"用户管理",subTitle:"",loading:t.vxeModalLoading},on:{confirm:function(e){return t.submitEvent()}},model:{value:t.showEditRoleUsersBox,callback:function(e){t.showEditRoleUsersBox=e},expression:"showEditRoleUsersBox"}},[i("div",{ref:"editBoxBodyContent",staticClass:"editBoxBodyContentDefaultHW"},[i("editBoxContentPartition",{attrs:{config:{windowOffsetHeight:t.windowOffsetHeight,windowOffsetWidth:t.windowOffsetWidth}},scopedSlots:t._u([{key:"part1",fn:function(){return[i("div",{staticClass:"roleUsersBox",style:{height:t.windowOffsetHeight+"px"}},[i("div",{staticClass:"roleUsersItem firstItem"},[i("nvxe-edit-grid",{ref:"firstTable",attrs:{toolbarConfigShow:!1,height:t.windowOffsetHeight-5,columnsFormName:t.requstConfig.tab1FormName},on:{"checkbox-change":t.canAddDataCheck,"checkbox-all":t.canAddDataCheck},scopedSlots:t._u([{key:"top",fn:function(){return[i("div",{staticClass:"borderSetting cl-title-cb"},[i("span",{staticClass:"margin-left-10"},[t._v("未有角色用户")])])]},proxy:!0}])})],1),i("div",{staticClass:"roleUsersItem secondItem"},[i("div",{staticClass:"secondSubItemBox"},[i("div",{staticClass:"secondSubItem"},[i("vxe-button",{attrs:{disabled:!t.canAddData,status:"success"},on:{click:function(e){return t.addDataEvent()}}},[i("div",{staticClass:"iconTextCenter"},[i("span",{staticClass:"textMargin5"},[t._v("添加")]),t._v(" "),i("i",{staticClass:"vxe-icon--d-arrow-right"})])])],1),i("div",{staticClass:"secondSubItem"},[i("vxe-button",{attrs:{disabled:!t.canRemoveData,status:"danger"},on:{click:function(e){return t.removeDataEvent()}}},[i("div",{staticClass:"iconTextCenter"},[i("i",{staticClass:"vxe-icon--d-arrow-left"}),t._v(" "),i("span",{staticClass:"textMargin5"},[t._v("移除")])])])],1)])]),i("div",{staticClass:"roleUsersItem thirdItem"},[i("nvxe-edit-grid",{ref:"secondTable",attrs:{toolbarConfigShow:!1,height:t.windowOffsetHeight-5,columnsFormName:t.requstConfig.tab2FormName},on:{"checkbox-change":t.canRemoveDataCheck,"checkbox-all":t.canRemoveDataCheck},scopedSlots:t._u([{key:"top",fn:function(){return[i("div",{staticClass:"borderSetting cl-title-cb"},[i("span",{staticClass:"margin-left-10"},[t._v("已有角色用户")])])]},proxy:!0}])})],1)])]},proxy:!0}])})],1)])},w=[],v=(i("e3b5"),i("47b8"),i("24a8"),i("6b6c")),C={name:"edit-roleUsers",components:{},props:{currentRoleId:{type:String,default:""}},data:function(){return{canAddData:!1,canRemoveData:!1,firstTableDataList:[],secondTableDataList:[],vxeModalLoading:!1,windowOffsetHeight:0,windowOffsetWidth:0,showEditRoleUsersBox:!1,requstConfig:{modulePreUrl:"/sys/role",tab1FormName:"roleUserFm",tab2FormName:"roleUserFm"}}},computed:{windowIsResize:function(){return this.$store.state.app.windowIsResize.editWindow}},watch:{windowIsResize:function(t,e){this.getContentWindowWidthHeight()},showEditRoleUsersBox:function(t,e){var i=this;t?(this.getContentWindowWidthHeight(),this.$nextTick((function(){i.getUsersWithRole()}))):this.resetData()}},methods:{resetData:function(){this.canAddData=!1,this.canRemoveData=!1,this.firstTableDataList=[],this.secondTableDataList=[],this.vxeModalLoading=!1},canAddDataCheck:function(){try{var t=this.$refs["firstTable"].$refs["originEditTalbe"];this.canAddData=!!t&&t.getCheckboxRecords().length>0}catch(e){this.canAddData=!1}},canRemoveDataCheck:function(){try{var t=this.$refs["secondTable"].$refs["originEditTalbe"];this.canRemoveData=!!t&&t.getCheckboxRecords().length>0}catch(e){this.canRemoveData=!1}},submitEvent:function(){var t=this.$refs["secondTable"].$refs["originEditTalbe"];if(t){var e="/sys/role/saveUser",i=t.getTableData().tableData;i.length>0&&(i=i.map((function(t){return t.id.includes("row_")&&(t.id=null),t})));var s={roleId:this.currentRoleId,sysUserRoleList:i},o=this;v["a"].post(e,s).then((function(t){o.$XModal.message({message:"操作成功!",status:"success"}),o.$emit("refreshDataList",""),o.showEditRoleUsersBox=!1}))}},addDataEvent:function(){var t=this.$refs["firstTable"].$refs["originEditTalbe"];if(t){var e=t.getCheckboxRecords(),i=this.$refs["secondTable"].$refs["originEditTalbe"];i&&(i.insertAt(e,-1),this.setFirstTableData())}this.canAddData=!1},removeDataEvent:function(){var t=this.$refs["secondTable"].$refs["originEditTalbe"];if(t){t.getCheckboxRecords();t.removeCheckboxRow(),this.setFirstTableData()}this.canRemoveData=!1},setFirstTableData:function(){var t=this.$refs["firstTable"].$refs["originEditTalbe"],e=this.$refs["secondTable"].$refs["originEditTalbe"];if(t){var i=e.getTableData().tableData,s=[].concat(this.firstTableDataList),o=s.filter((function(t){var e=i.findIndex((function(e){return t.userId==e.userId}));if(-1==e)return t}));t.reloadData(o)}},setSecondTableData:function(){var t=this.$refs["secondTable"].$refs["originEditTalbe"];t&&t.reloadData(this.secondTableDataList)},getUsersWithoutRole:function(){var t="/sys/role/getUserInfo",e={},i=this;v["a"].post(t,e).then((function(t){i.firstTableDataList=t,i.setFirstTableData()}))},getUsersWithRole:function(){var t="/sys/role/role-user?roleId=".concat(this.currentRoleId),e={},i=this;v["a"].post(t,e).then((function(t){i.secondTableDataList=t,i.setSecondTableData(),i.getUsersWithoutRole()}))},getContentWindowWidthHeight:function(){this.vxeModalLoading=!0;var t=this;this.$nextTick((function(){t.windowOffsetHeight=0,t.windowOffsetWidth=0,clearTimeout(t.editWindowReSizeTimer),t.editWindowReSizeTimer=setTimeout((function(){var e=t.$refs["editBoxBodyContent"];if(e&&e.offsetHeight){var i=e.offsetHeight,s=e.offsetWidth;t.windowOffsetHeight=Number(i),t.windowOffsetWidth=Number(s)}t.vxeModalLoading=!1}),300)}))}}},D=C,p=(i("6a88"),Object(h["a"])(D,g,w,!1,null,"1159527b",null)),x=p.exports,T=i("1b62"),I=i("2ddf"),R=i("0e4a"),y={name:"codeList",components:{editBox:b,editRoleUsers:x,bodyContentDownItem:R["a"]},data:function(){return{headerCellDblClickInfo:{},hasUpdateRecords:!1,firstTableLoading:!1,secondTableLoading:!1,thirdTableLoading:!1,currentResourceId:"",currentRoleId:"",menuDataList:[],toolbarConfig:{slots:{buttons:"toolbar_buttons"}},requstConfig:{modulePreUrl:"/sys/role",mainFormName:"sysroleFm",tab1FormName:"sysroleresourceFm",tab2FormName:"sysroleresourceexpFm",tab3FormName:"sysrolereportFm",tab4FormName:"roleUserFm"}}},mixins:[T["a"],I["a"]],created:function(){this.getMenuDataList()},methods:{refreshDataList:function(){this.getRoleUserList()},iisUsersMAction:function(){var t=this.$refs["editRoleUsers"];t&&(t.showEditRoleUsersBox=!0)},iisRightsSAction:function(){var t=this;this.$XModal.confirm({status:"warning",message:"确定要保存权限？"}).then((function(e){"confirm"===e&&t.submitUpdateDataList()}))},formatPostData:function(){var t={roleId:this.currentRoleId,roleReportList:this.getUpdateDataList("thirdTable"),roleResourceExpList:this.getUpdateDataList("secondTable"),roleResourceList:this.getUpdateDataList("firstTable")};return t},submitUpdateDataList:function(){var t=this,e="/sys/role/save-auth",i=this.formatPostData();this.request.post(e,i).then((function(e){t.hasUpdateRecords=!1,t.headerCellDblClickInfo={},t.$XModal.message({message:"操作成功!",status:"success"}),setTimeout((function(){t.reloadTableData()}),100)}))},getUpdateDataList:function(t){var e=this.$refs[t],i=[];return e&&(i=e.getUpdateRecords(),i.length>0&&(this.hasUpdateRecords=!0,i=i.map((function(t){return t.id.includes("row_")&&(t.id=null),t})))),i},indexCellDblClickEvent:function(t,e){if(e.columnsFormName){var i=["iisAdd","iisAudit","iisDel","iisDisabled","iisEdit","iisExport","iisImport","iisMoney","iisNotAudit","iisPrint","iisShow"],s=this.$refs[t].$refs["originEditTalbe"];if(s){var o=[e.rowInfo.row];o=o.map((function(t){return i.forEach((function(e){t.hasOwnProperty(e)&&(t[e]=!t[e])})),t}))}}},headerCellDblClickEvent:function(t,e){if(e.columnsFormName){this.headerCellDblClickInfo[t]=!0;var i=e.rowInfo.column.property;if(1!=e.rowInfo.$columnIndex){var s=this.$refs[t].$refs["originEditTalbe"];if(s){var o=s.getTableData().tableData;if(e.rowInfo.$columnIndex>1)o=o.map((function(t){return t[i]=!t[i],t}));else{var a=["iisRight","iisAdd","iisAudit","iisDel","iisDisabled","iisEdit","iisExport","iisImport","iisMoney","iisNotAudit","iisPrint","iisShow"];o=o.map((function(t){return a.forEach((function(e){t.hasOwnProperty(e)&&(t[e]=!t[e])})),t}))}}}}},cellClickEvent:function(t){var e=this;clearTimeout(this.selectTimer),this.selectTimer=setTimeout((function(){e.currentRoleId=t.row.id,e.reloadTableData()}),100)},setCurrentRowEvent:function(t){this.currentRoleId=t.row.id,this.reloadTableData()},reloadTableData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";"0"!=this.currentResourceId&&this.currentResourceId&&"0"!=this.currentRoleId&&this.currentRoleId&&(this.getSubTableData("firstTable"),this.getSubTableData("secondTable"),this.getSubTableData("thirdTable")),"0"!=this.currentRoleId&&this.currentRoleId&&"handleNodeClick"!=t&&this.getRoleUserList()},handleNodeClick:function(t){var e=this;this.formatPostData(),e.hasUpdateRecords?e.$XModal.confirm({status:"warning",message:"有未提交更新数据,是否提交?"}).then((function(i){"confirm"===i?(e.submitUpdateDataList(),setTimeout((function(){e.refreshDataSearch(t)}),300)):e.refreshDataSearch(t)})):e.refreshDataSearch(t)},refreshDataSearch:function(t){this.hasUpdateRecords=!1,t&&t.id&&(this.currentResourceId=t.id,this.reloadTableData("handleNodeClick"))},getMenuDataList:function(){var t=this;0==this.menuDataList.length&&this.request.get("/sys/resource/tree").then((function(e){t.menuDataList=e}))},getRoleUserList:function(){var t=this.$refs["fourthTable"].$refs["originListTalbe"],e="/sys/role/role-user?roleId=".concat(this.currentRoleId),i={};t&&this.request.post(e,i).then((function(e){t.reloadData(e)}))},getSubTableData:function(t){var e=this,i=this.$refs[t].$refs["originEditTalbe"],s="",o={};if(this[t+"Loading"]=!0,i){switch(t){case"firstTable":s="/sys/role/getRoleResource?resourceId=".concat(this.currentResourceId,"&roleId=").concat(this.currentRoleId);break;case"secondTable":s="/sys/role/role-expand?resourceId=".concat(this.currentResourceId,"&roleId=").concat(this.currentRoleId);break;case"thirdTable":s="/sys/role/role-report?resourceId=".concat(this.currentResourceId,"&roleId=").concat(this.currentRoleId);break;default:break}this.request.post(s,o).then((function(s){e[t+"Loading"]=!1,i.reloadData(s)}))}}}},k=y,E=(i("2cb6"),Object(h["a"])(k,s,o,!1,null,"4ed2d97c",null));e["default"]=E.exports},ab8f:function(t,e,i){"use strict";i("f3cf")},c294:function(t,e,i){},f3cf:function(t,e,i){}}]);